# 2장. 개략적인 규모 추정


개략적인 규모 추정을 효과적으로 하기 위해선, "2의 제곱수", "응답 지연 값", "가용서 관련 수치"들을 이해하고 있어야한다.

### 2의 제곱수

| **2의 제곱수** | **근사치** | **이름** | **축약형** |
| --- | --- | --- | --- |
| 10 | 1천 (thousand) | 1킬로바이트 (Kilobyte) | 1KB |
| 20 | 1백만 (million) | 1메가바이트 (Megabyte) | 1MB |
| 30 | 10억 (billion) | 1기가바이트 (Gigabyte) | 1GB |
| 40 | 1조 (trillion) | 1테라바이트 (Terabyte) | 1TB |
| 50 | 1000조 (quadrillion) | 1페타바이트 (Petabyte) | 1PB |

### 연산별 응답 지연 시간

| **연산명** | **시간** |
| --- | --- |
| L1 캐시 참조 | 0.5ns |
| 분기 예측 오류 (branch mispredict) | 5ns |
| L2 캐시 참조 | 7ns |
| 뮤텍스(mutex) 락/언락 | 100ns |
| 주 메모리 참조 | 100ns |
| Zippy로 1KB 압축 | 10,000ns = 10μs |
| 1Gbps 네트워크로 2KB 전송 | 20,000ns = 20μs |
| 메모리에서 1MB 순차적으로 read | 250,000ns = 250μs |
| 같은 데이터 센터 내에서의 메시지 왕복 지연 시간 | 500,000ns = 500μs |
| 디스크 탐색(seek) | 10,000,000ns = 10ms |
| 네트워크에서 1MB 순차적으로 read | 10,000,000ns = 10ms |
| 디스크에서 1MB 순차적으로 read | 30,000,000ns = 30ms |
| 한 패킷이 CA(캘리포니아)로부터 네덜란드까지 왕복 지연시간 | 150,000,000ns = 150ms |

## **응답 지연 값**

응답 지연 값을 분석하면 다음과 같은 결론을 도출 할 수 있다.

    - 메모리는 빠르다. 디스크는 느리다.
    - 디스크 탐색은 가능한 피하자
    - 단순 압축 알고리즘은 빠르다.
    - 데이터를 인터넷으로 전송하기 전에 가능하면 압축하자
    - 서로 다른 region 데이터 센터 간 소통은 시간이 걸린다

## **가용성 관련 수치들** 

“고가용성”이란?
    
    → 오랜시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 지칭하는 용어
    
    고가용성을 표현하는 값은 퍼센트로 표현하는데, 
    
    100% 는 시스템이 단 한번도 중단된 적이 없었음을 의미한다. 
    
    대부분의 서비스는 99% ~ 100% 사잇값을 갖는다. 
    
“SLA(Service Level Agreement)” 이란?
    
    → 서비스 사업자가 보편적으로 사용하는 용어로, 사업자와 고객 사이에 맺어진 합의를 의미한다. 
    
    SLA 에는 서비스의 가용시간(uptime)이 공식적으로 기술되어 있다. 
    

<details>
<summary> 예제 : QPS와 저장소 요구량 추정 </summary>
- 전제
        
      MAU(특정 월에 적어도 한 번 이상 서비스를 이용한 사용자 수) : 3억명 
    
      유저의 50% 가 매일 사용한다. 
      
      평균적으로 각사용자는 매일 2건을 업로드한다. 
      
      미디어를 포함하는 업로드는 10% 정도이다. 
      
      데이터는 5년간 보관한다. 
      
    평균 업로드 크기 (id : 64byte, txt :140byte, 미디어 1MB)
  
- QPS(Query Per sec) 추정치 

      DAU = MAU * 50 % = 1.5억 
      QPS = $\frac{3억}{86400}$ = 3500 약 
    
- 미디어 저장을 위한 저장소 요구량 
    
      DAU = MAU * 50 % = 1.5억   
      1.5억 * 2 * 10% * 1MB
      30,000,000 MB/일 = 30,000 GB/일 = **30 TB/일**
    
- 5년짜리 미디어 보관 저장소 크기 
    
      30 TB * 1800 ⇒ 54 PB

</details>

  
        
    
